webpackJsonp([0],[function(e,t,n){var o=n(1);n(2),n(4),n(6),n(8),n(10),n(12),n(13),n(14),n(15),n(18),n(19),n(20),n(21),n(22),n(30),n(31),n(32),n(33),n(34),n(35),n(38),n(39),n(40),n(41),n(42),angular.module("dc.doclist",["ngTouch","ngAnimate","mgcrea.ngStrap","dc.doclist.route","dc.shared.webviewbridge.webviewbridge"]).config(["$apiProvider","webViewBridgeProvider",function(e,t){}]).run(function(){o.attach(document.body)})},,,,,,,,,,,,,,,function(e,t,n){var o={"doclist.html":n(16),"doc_preview.html":n(17)};angular.module("dc.doclist.route",["ngRoute","dc.components.doclist.docCtrl","dc.components.preview.previewCtrl"]).config(["$routeProvider",function(e){e.when("/docs/",{templateUrl:o["doclist.html"],controller:"DocListCtrl"}).when("/docs/:docId/:version/preview/",{templateUrl:o["doc_preview.html"],controller:"DocPreviewCtrl"}).otherwise({redirectTo:"/docs/"})}])},function(e,t){var n="components/doclist/doclist.html",o='<div id=doclist class=container-fluid ng-cloak><bottom-bar></bottom-bar><div class="row doclist-header">Funding Package</div><div class="row doclist-container"><doc class=pull-left doc=doc ng-repeat="doc in data.fundingDocs" docs-repeat-complete></doc></div><div class="row doclist-header">Other</div><div class="row doclist-container"><doc class=pull-left doc=doc master-index-id=masterIndexId ng-repeat="doc in data.otherDocs"></doc></div></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/preview/doc_preview.html",o='<div id=docpreview class=container-fluid><div class=docpreview-container><div class=docpreview-content><img ng-repeat="page in pages" ng-src=data:image/png;base64,{{page}}></div></div></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){angular.module("dc.components.doclist.constants",[]).constant("DOC_STATUS_MAPPING",{"not-signed":"Not Signed",signed:"Signed","partially-signed":"Partially Signed",submitted:"Submitted"}).constant("SIGNER_TYPE_MAPPING",{buyer:"Applicant",cobuyer:"Co-applicant",dealer:"Dealer"})},function(e,t){angular.module("dc.components.doclist.docCtrl",["dc.components.doclist.docService","dc.components.doclist.ui","dc.components.doclist.filters"]).controller("DocListCtrl",["$scope","$api","docService","signerService","docTypeService","webViewBridge",function(e,t,n,o,c,i){e.data=n,c.init().then(t.getDealJacketInfo).then(function(t){var c=t.data;e.signers=c.signers,n.refresh(t.data.docs),o.init(e.signers),i.logEvent("doclist initialized")}),i.registerFunction("reload",function(){n.refresh()})}])},function(e,t){angular.module("dc.components.doclist.docService",["dc.components.doclist.constants","dc.shared.api.api"]).factory("Doc",["DOC_STATUS_MAPPING","SIGNER_TYPE_MAPPING","signerService","docTypeService",function(e,t,n,o){function c(e){_.extend(this,e),this.selected=!1}return c.prototype={get signed(){return this.signable&&"signed"==this.status},get submitted(){return this.signable&&"submitted"==this.status},get isPlaceholder(){return this.isExternal&&"initial"==this.status},get isContract(){return"contract"==this.docType},get templateName(){if("other"==this.docType)return this.customTemplateName;var e=o.templateName(this.docType);return e||this.customTemplateName},signerName:function(e){return n[e].name+("dealer"==e?"":" ("+n[e].type+")")},signerSigned:function(e){return this.signStatus[e]},get actualRequiredSigners(){return _.filter(this.requiredSigners,function(e){return!!n[e]})}},c}]).factory("docService",["$q","$api","Doc","signerService","docTypeService","DOC_STATUS_MAPPING","SIGNER_TYPE_MAPPING",function(e,t,n,o,c,i,r){var s={id:null,docs:[],refresh:function(e){e?s.docs=_.chain(e).filter(function(e){return"removed"!=e.status}).map(function(e){return new n(e)}).value():t.getDocList().then(function(e){if(302!=e.status){var t=e.data;s.id=t.id,s.docs=_.chain(t.docs).filter(function(e){return"removed"!=e.status}).map(function(e){return new n(e)}).value()}})},submitSignedDocs:function(){var n=_.pluck(this.signedDocs,"id");console.log("submitting"+JSON.stringify(n));var o=e.defer();return t.submitDocs(n).then(function(e){302!=e.status&&204==e.status&&o.resolve()}),o.promise},get contractDoc(){var e=this.docs.filter(function(e){return e.isContract});return e.length>=1?e[0]:null},get contractSigned(){var e=this.contractDoc;return e?e.signed||e.submitted:!1},get contractSubmitted(){return this.contractDoc?this.contractDoc.submitted:!1},get fundingDocs(){return this.docs.filter(function(e){return e.requiredForFunding})},get otherDocs(){return this.docs.filter(function(e){return!e.requiredForFunding})},get hasSelected(){return _.some(this.docs,function(e){return e.selected})},get selectedDocs(){return this.docs.filter(function(e){return e.selected})},get signedDocs(){return this.docs.filter(function(e){return e.signed})},get requiredSignersInSelectedDocs(){return _.union.apply(_,_.map(this.selectedDocs,function(e){return _.filter(e.actualRequiredSigners,function(t){return!e.signStatus[t]})}))},isSignerRequiredBySelectedDocs:function(e){return _.some(this.selectedDocs,function(t){return _.contains(t.requiredSigners,e)&&!t.signStatus[e]})}};return s}]).factory("docTypeService",["$q","$api",function(e,t){var n={init:function(){var o=e.defer();return t.getDocTypes().then(function(e){n.docTypes=e.data.docTypes,n.docTypesLookup={},_.each(n.docTypes,function(e){n.docTypesLookup[e.code]=e}),o.resolve()}),o.promise},templateName:function(e){return e in n.docTypesLookup?n.docTypesLookup[e].name:null},get externalDocTypes(){return _.filter(n.docTypes,"isExternal")}};return n}]).factory("Signer",["SIGNER_TYPE_MAPPING",function(e){function t(e,t){_.extend(this,e),this.name=_.filter([this.firstName,this.lastName]).join(" "),this.type=t,this.selected=!1}return t}]).factory("signerService",["Signer",function(e){var t={buyer:null,cobuyer:null,dealer:null,init:function(t){this.buyer=this.makeSigner(t.buyer,"buyer"),this.cobuyer=this.makeSigner(t.cobuyer,"cobuyer"),this.dealer=new e({firstName:"Dealer",lastName:"dealer"},"dealer")},makeSigner:function(t,n){return!t||null==t.firstName&&null==t.lastName?null:new e(t,n)},get selectedSigners(){var e=[];return _.each(["buyer","cobuyer","dealer"],function(n){t[n]&&t[n].selected&&e.push(n)}),e}};return t}])},function(e,t){angular.module("dc.components.doclist.filters",["dc.components.doclist.constants"]).filter("signerTypeName",["SIGNER_TYPE_MAPPING",function(e){return function(t){return e[t]}}]).filter("docStatusName",["DOC_STATUS_MAPPING",function(e){return function(t){return e[t]}}])},function(e,t,n){var o={"add_document_modal.html":n(23),"doclist_doc.html":n(24),"bottom_bar.html":n(25),"select_signer_modal.html":n(26),"submit_docs_confirm.html":n(27),"signstatus_popover.html":n(28),"more_popover.html":n(29)};angular.module("dc.components.doclist.ui",["dc.shared.ui.uiService","dc.shared.ui.uiDirective","dc.components.doclist.docService","dc.shared.webviewbridge.webviewbridge"]).factory("docTypeDialog",["$commonDialog","$q","$rootScope","docTypeService",function(e,t,n,c){return function(i){var r=i.scope&&i.scope.$new()||n.$new(),s=t.defer();return r.docTypeService=c,r.applicantChoices=[{id:"buyer",name:"Applicant"},{id:"cobuyer",name:"Co-Applicant"}],r.selectedDocType=i.docType,r.selectedApplicantType=i.applicantType,r.docTypeDisabled=i.docTypeDisabled||!1,r.applicantTypeDisabled=i.applicantTypeDisabled||!1,r.onDocTypeSelect=function(e){r.selectedDocType=e},r.onApplicantTypeSelect=function(e){r.selectedApplicantType=e},e({title:i.title,ok:i.ok,width:500,templateUrl:o["add_document_modal.html"],scope:r,okEnabled:function(){return r.selectedDocType&&r.selectedApplicantType}}).then(function(){s.resolve({docType:r.selectedDocType,applicantType:r.selectedApplicantType})}),s.promise}}]).directive("doc",function(){return{templateUrl:o["doclist_doc.html"],restrict:"E",scope:{doc:"="},controller:["$scope","$api","docService","webViewBridge","SIGNER_TYPE_MAPPING","docTypeDialog","$msgbox","signerService",function(e,t,n,o,c,i,r,s){e.preview=null,e.showPreview=function(e){if(!e.isPlaceholder){var t={docType:e.docType,docTypeName:e.templateName,applicantType:e.scanApplicant,applicantTypeName:e.scanApplicant?c[e.scanApplicant]:void 0};o.logEvent("show document preview, document id="+e.id),o.startPreview(e.id,e.version,t)}},e.addDoc=function(e){e.isPlaceholder&&(null===s.cobuyer?(o.logEvent("start POS capture on placeholder, document id="+e.id),o.startPOSCapture(e.id,e.docType,"buyer")):i({title:"Add Document",docType:e.docType,docTypeDisabled:!0}).then(function(t){o.logEvent("start POS capture on placeholder, document id="+e.id),o.startPOSCapture(e.id,e.docType,t.applicantType)}))},e.moveDoc=function(){var c={requiredForFunding:!e.doc.requiredForFunding};t.updateDoc(e.doc.id,c).then(function(t){o.logEvent("document id="+e.doc.id+" was moved to "+(e.doc.requiredForFunding?"Other":"Funding Package")),n.refresh()})},e.editDoc=function(){i({title:"Update Properties",ok:"Save",docType:e.doc.docType,applicantType:e.doc.scanApplicant}).then(function(c){t.updateDoc(e.doc.id,{}).then(function(t){o.logEvent("document id="+e.doc.id+" properties was updated."),n.refresh()})})},e.deleteDoc=function(){t.deleteDoc(e.doc.id).then(function(){o.logEvent("document id="+e.doc.id+" was deleted."),n.refresh()})},e.onDocSelected=function(t){e.doc.selected=!e.doc.selected}}],link:function(e,t,n,o){e.$on("morePopover.moveDoc",function(t){e.moveDoc()}),e.$on("morePopover.editDoc",function(t){e.editDoc()}),e.$on("morePopover.deleteDoc",function(t){e.deleteDoc()})}}}).directive("bottomBar",function(){return{templateUrl:o["bottom_bar.html"],restrict:"E",scope:!0,controller:["$scope","docService","signerService","$modal","$msgbox","$commonDialog","docTypeDialog","webViewBridge",function(e,t,n,c,i,r,s,d){e.docService=t,e.signerService=n,e.onSignerSelected=function(e){n[e].selected=!n[e].selected},e.selectSigner=function(){e.signers=_.filter(["buyer","cobuyer","dealer"],function(e){return!!n[e]}),r({title:"Select Signer(s)",ok:"Continue",cancel:"Cancel",width:3==e.signers.length?526:361,templateUrl:o["select_signer_modal.html"],scope:e,okEnabled:function(){return e.signerService.selectedSigners.length>0}}).then(function(){var e=_.pluck(t.selectedDocs,"id"),o=n.selectedSigners;d.startSigningRoom(e,o)})},e.submitDocs=function(){i.confirm({templateUrl:o["submit_docs_confirm.html"],scope:e,title:"Submit Documents",ok:"Submit"}).then(function(){t.submitSignedDocs().then(function(e){i.alert("Document(s) have been successfully submitted to lender.")})})},e.printDocs=function(){var e=_.pluck(t.selectedDocs,"id");JSON.stringify({docIds:e});d.logEvent("start printing document ids="+e.join(",")),d.print(_.pluck(t.selectedDocs,"id"))},e.addDocument=function(){var e={title:"Add Document"};null===n.cobuyer&&(e.applicantType="buyer",e.applicantTypeDisabled=!0),s(e).then(function(e){d.logEvent("start POS capture: new document"),d.startPOSCapture(null,e.docType,e.applicantType)})}}]}}).directive("signerPopover",["$popover","$document","$animate",function(e,t,n){return{restrict:"EA",scope:!0,controller:["$scope","signerService",function(e,t){e.signerName=function(e){return t[e].name}}],link:function(c,i,r){var s={scope:c,templateUrl:o["signstatus_popover.html"],container:"body",placement:"top",autoClose:!0,viewport:{selector:"body",padding:10}},d=angular.element("<div>").addClass("am-fade").addClass("modal-backdrop"),a=t.find("body"),l=angular.element(a[0].lastChild),u=e(i,s);c.$on("tooltip.show.before",function(){n.enter(d,a,l)}),c.$on("tooltip.hide.before",function(){n.leave(d)}),c.$on("$destroy",function(){u&&u.destroy(),s=null,u=null})}}}]).directive("morePopover",["$popover","$document","$animate",function(e,t,n){return{restrict:"EA",scope:!0,controller:["$scope",function(e){e.moveDoc=function(){e.$emit("morePopover.moveDoc")},e.editDoc=function(){e.$emit("morePopover.editDoc")},e.deleteDoc=function(){e.$emit("morePopover.deleteDoc")}}],link:function(c,i,r){var s={scope:c,templateUrl:o["more_popover.html"],container:"body",placement:"top",autoClose:!0},d=angular.element("<div>").addClass("am-fade").addClass("modal-backdrop"),a=t.find("body"),l=angular.element(a[0].lastChild),u=e(i,s);c.$on("tooltip.show.before",function(){n.enter(d,a,l)}),c.$on("tooltip.hide.before",function(){n.leave(d)}),c.$on("$destroy",function(){u&&u.destroy(),s=null,u=null}),i.children().eq(0).css({left:"75%"})}}}])},function(e,t){var n="components/doclist/add_document_modal.html",o='<div class=add-document-body><button type=button class="btn btn-default doc-type-selector" bs-select ng-model=selectedDocType bs-options="docType.code as docType.name for docType in docTypeService.externalDocTypes" data-placeholder="Select Document Type" ng-change=onDocTypeSelect(selectedDocType) ng-disabled=docTypeDisabled>Action <span class=caret></span></button> <button type=button class="btn btn-default doc-type-selector" bs-select ng-model=selectedApplicantType bs-options="applicant.id as applicant.name for applicant in applicantChoices" data-placeholder="Select Person" ng-change=onApplicantTypeSelect(selectedApplicantType) ng-disabled=applicantTypeDisabled>Action <span class=caret></span></button></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/doclist/doclist_doc.html",o='<div class=document ng-click="doc.isPlaceholder ? addDoc(doc) : showPreview(doc)"><signer-popover ng-if="doc.signable && doc.requiredSigners.length > 0" class="status-badge {{doc.status}}" id=signing-status-for-{{doc.id}} ng-click=$event.stopPropagation()><div class=status>{{doc.status | docStatusName}}</div></signer-popover><button icon-button=icn-checkbox width=30 height=30 class=doc-selector ng-checked=doc.selected ng-if=!doc.isPlaceholder ng-click=onDocSelected(doc.id);$event.stopPropagation()></button><div class=doc-body id=doc-body-{{doc.id}}><div class=doc-title-block><p class="text-center doc-title" ng-if=!doc.isPlaceholder>{{doc.templateName}}</p><p class="text-center doc-placeholder-title" ng-if=doc.isPlaceholder>{{doc.templateName}}</p><p class="text-center doc-applicant-name" ng-if=doc.scanApplicant>{{doc.scanApplicant | signerTypeName }}</p></div><button class=doc-btn-add icon-button=icn-add-blue ng-if=doc.isPlaceholder ng-click=addDoc(doc);$event.stopPropagation()>Add</button></div><more-popover class=doc-btn-more ng-hide=doc.isContract ng-click=$event.stopPropagation()><button icon-button=icn-more height=30>More</button></more-popover></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/doclist/bottom_bar.html",o='<div class=doclist-bottom-bar><button icon-button=icn-print class=pull-left ng-disabled=!docService.hasSelected ng-click=printDocs()>Print</button> <button icon-button=icn-sign class=pull-left ng-disabled="docService.requiredSignersInSelectedDocs.length == 0" ng-click=selectSigner()>Sign</button> <button icon-button=icn-add class=pull-right ng-click=addDocument()>Add Document</button> <button id=submit-button class="btn btn-success" ng-show=docService.contractSigned ng-click=submitDocs()>{{docService.contractSubmitted ? "Submit to Lender" : "Submit for Funding"}}</button></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/doclist/select_signer_modal.html",o='<div class=signer-modal-body><ul class="row signers-list" ng-class="\'room-for-\'+signers.length"><li ng-repeat="signerType in signers" class="modal-body-wrapper signers-list-item signer-{{signer.Type.toLowerCase()}}"><div class=signer><button icon-button=icn-checkbox class=signer-selector width=30 height=30 ng-checked=signerService[signerType].selected ng-show=docService.isSignerRequiredBySelectedDocs(signerType) ng-click=onSignerSelected(signerType)></button><div class=signer-caption><div class=signer-name>{{signerService[signerType].name}}</div><div class=signer-type>{{signerService[signerType].type | signerTypeName}}</div></div></div></li></ul></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/doclist/submit_docs_confirm.html",o='<p>The following document(s) will be sent to lender:</p><ul><li ng-repeat="doc in docService.signedDocs">{{doc.templateName}}</li></ul>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/doclist/signstatus_popover.html",o='<div class="popover signstatus-popover"><h3 class=popover-title>Status</h3><div class=popover-content><div class="signstatus-row clearfix" ng-repeat="signerType in doc.actualRequiredSigners"><div class="signstatus-signer pull-left">{{signerName(signerType)}} <span class=signstatus-signer-type ng-if="signerType != \'dealer\'">({{signerType | signerTypeName }})</span></div><div class="signstatus-status pull-right"><span ng-if=doc.signerSigned(signerType) class=signstatus-signed>Signed</span> <span ng-if=!doc.signerSigned(signerType) class=signstatus-notsigned>Not Signed</span></div></div></div></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){var n="components/doclist/more_popover.html",o='<div class="popover more-popover"><div class=arrow></div><div class=popover-content><ul class=more-menu><li class=more-menu-item ng-click=moveDoc();$hide()><a>{{ doc.requiredForFunding ? "Move to Other" : "Move to Funding Package" }}</a></li><li class=more-menu-item ng-click=editDoc();$hide() ng-if="doc.isExternal && !doc.isPlaceholder"><a>Update Properties</a></li><li class=more-menu-item ng-click=deleteDoc();$hide() ng-if="doc.isExternal && !doc.isPlaceholder"><a>Delete</a></li></ul></div></div>';window.angular.module("ng").run(["$templateCache",function(e){e.put(n,o)}]),e.exports=n},function(e,t){angular.module("dc.components.preview.previewCtrl",["ngRoute","dc.shared.api.api"]).controller("DocPreviewCtrl",["$scope","$routeParams","$api",function(e,t,n){n.getDocPreview(t.docId,t.version).then(function(t){if(302!=t.status){var n=t.data;e.title=n.title,e.id=n.id,e.version=n.version,e.pages=n.pages}})}])}]);